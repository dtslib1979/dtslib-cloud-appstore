<!DOCTYPE html>
<html lang="ko" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>10sec 적분 쇼츠 v1.0</title>
    <link rel="manifest" href="./manifest.json">
    <link rel="apple-touch-icon" href="./icons/icon-192x192.png">
    <meta name="theme-color" content="#1a1a2e">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="description" content="짧은 영상들을 합쳐서 유튜브 쇼츠로 자동 변환">
    <link rel="stylesheet" href="./style.css">
    <link rel="preload" href="https://unpkg.com/@ffmpeg/ffmpeg@0.11.6/dist/ffmpeg.min.js" as="script">
</head>
<body>
    <div class="container">
        <header>
            <div class="header-row">
                <h1>🎬 10sec 적분 쇼츠</h1>
                <button class="theme-toggle" onclick="toggleTheme()" title="테마 변경">
                    <span id="themeIcon">🌙</span>
                </button>
            </div>
            <p class="subtitle">짧은 영상들 → 3분 쇼츠로 합치기</p>
            <div class="version-row">
                <span class="version">v1.0</span>
                <span id="engineInfo" class="engine-badge">검사 중...</span>
            </div>
        </header>

        <main>
            <!-- Step 1: Multi Video Selection -->
            <section class="step-card">
                <div class="step-header">
                    <span class="step-num">1</span>
                    <span class="step-title">영상 선택 (여러 개)</span>
                </div>
                <div class="file-drop-zone" id="dropZone"
                     onclick="document.getElementById('videoInput').click()"
                     ondragover="handleDragOver(event)"
                     ondrop="handleDrop(event)">
                    <input type="file" id="videoInput" accept="video/*" multiple hidden>
                    <div class="drop-content">
                        <span class="drop-icon">📁</span>
                        <span class="drop-text">클릭 또는 드래그</span>
                        <span class="drop-hint">여러 영상 동시 선택 가능</span>
                    </div>
                </div>
            </section>

            <!-- Step 2: Clip List -->
            <section class="step-card" id="clipSection" style="display:none;">
                <div class="step-header">
                    <span class="step-num">2</span>
                    <span class="step-title">클립 순서 (드래그로 변경)</span>
                </div>
                <div id="clipList" class="clip-list"></div>
                <div class="clip-summary">
                    <span id="totalClips">0개 클립</span>
                    <span class="separator">·</span>
                    <span id="totalDuration">0:00</span>
                    <span class="separator">→</span>
                    <span id="adjustedDuration">0:00</span>
                </div>
                <button class="clear-btn" onclick="clearAllClips()">🗑️ 전체 삭제</button>
            </section>

            <!-- Step 3: Speed Control -->
            <section class="step-card" id="speedSection" style="display:none;">
                <div class="step-header">
                    <span class="step-num">3</span>
                    <span class="step-title">⚡ 속도 조절</span>
                </div>
                <div class="speed-control">
                    <input type="range" id="speedSlider" min="50" max="200" value="100"
                           class="speed-slider" oninput="updateSpeed()">
                    <div class="speed-labels">
                        <span>0.5x</span>
                        <span id="speedValue" class="speed-value">1.0x</span>
                        <span>2.0x</span>
                    </div>
                </div>
                <div class="speed-presets">
                    <button onclick="setSpeed(75)">0.75x</button>
                    <button onclick="setSpeed(100)" class="active">1.0x</button>
                    <button onclick="setSpeed(125)">1.25x</button>
                    <button onclick="setSpeed(150)">1.5x</button>
                </div>
            </section>

            <!-- Step 4: Effects -->
            <section class="step-card" id="effectSection" style="display:none;">
                <div class="step-header">
                    <span class="step-num">4</span>
                    <span class="step-title">✨ 효과 설정</span>
                </div>

                <div class="effect-group">
                    <label class="effect-label">🎬 오프닝 효과</label>
                    <div class="effect-buttons" id="openingEffects">
                        <button class="effect-btn active" onclick="setOpening('none')" data-effect="none">
                            <span class="effect-icon">⊘</span>
                            <span class="effect-name">없음</span>
                        </button>
                        <button class="effect-btn" onclick="setOpening('tv')" data-effect="tv">
                            <span class="effect-icon">📺</span>
                            <span class="effect-name">TV</span>
                        </button>
                        <button class="effect-btn" onclick="setOpening('vhs')" data-effect="vhs">
                            <span class="effect-icon">📼</span>
                            <span class="effect-name">VHS</span>
                        </button>
                        <button class="effect-btn" onclick="setOpening('focus')" data-effect="focus">
                            <span class="effect-icon">🎯</span>
                            <span class="effect-name">FOCUS</span>
                        </button>
                        <button class="effect-btn" onclick="setOpening('zoom')" data-effect="zoom">
                            <span class="effect-icon">🔍</span>
                            <span class="effect-name">ZOOM</span>
                        </button>
                    </div>
                </div>

                <div class="effect-group">
                    <label class="effect-label">🏁 엔딩 효과</label>
                    <div class="effect-buttons" id="endingEffects">
                        <button class="effect-btn active" onclick="setEnding('none')" data-effect="none">
                            <span class="effect-icon">⊘</span>
                            <span class="effect-name">없음</span>
                        </button>
                        <button class="effect-btn" onclick="setEnding('tv')" data-effect="tv">
                            <span class="effect-icon">📺</span>
                            <span class="effect-name">TV</span>
                        </button>
                        <button class="effect-btn" onclick="setEnding('vhs')" data-effect="vhs">
                            <span class="effect-icon">📼</span>
                            <span class="effect-name">VHS</span>
                        </button>
                        <button class="effect-btn" onclick="setEnding('focus')" data-effect="focus">
                            <span class="effect-icon">🎯</span>
                            <span class="effect-name">FOCUS</span>
                        </button>
                        <button class="effect-btn" onclick="setEnding('zoom')" data-effect="zoom">
                            <span class="effect-icon">🔍</span>
                            <span class="effect-name">ZOOM</span>
                        </button>
                    </div>
                </div>
            </section>

            <!-- Step 5: Output Settings -->
            <section class="step-card" id="outputSection" style="display:none;">
                <div class="step-header">
                    <span class="step-num">5</span>
                    <span class="step-title">📤 출력 설정</span>
                </div>
                <div class="output-info">
                    <div class="info-row">
                        <span class="info-label">예상 파트 수:</span>
                        <span id="partCount" class="info-value">1개</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">파트당 길이:</span>
                        <span class="info-value">최대 3분</span>
                    </div>
                </div>
                <div class="resolution-select">
                    <label>해상도:</label>
                    <select id="resolutionSelect">
                        <option value="720">720p (추천)</option>
                        <option value="1080">1080p (고화질)</option>
                        <option value="480">480p (빠름)</option>
                    </select>
                </div>
            </section>

            <!-- Generate Button -->
            <section class="step-card generate-card" id="generateSection" style="display:none;">
                <button id="generateBtn" class="generate-btn" onclick="generate()" disabled>
                    <span class="btn-icon">🚀</span>
                    <span class="btn-text">쇼츠 생성하기</span>
                </button>
            </section>

            <!-- Progress -->
            <section id="progressSection" class="progress-section" style="display:none;">
                <div class="progress-header">
                    <span id="status" class="status">준비 중...</span>
                    <button onclick="abort()" class="abort-btn">⏹️ 중단</button>
                </div>
                <div class="progress-bar-container">
                    <div class="progress-bar">
                        <div id="progressFill" class="progress-fill"></div>
                    </div>
                    <span id="progressText" class="progress-text">0%</span>
                </div>
                <div id="progressLog" class="progress-log"></div>
            </section>

            <!-- Results -->
            <section id="resultSection" class="result-section" style="display:none;">
                <div class="result-header">
                    <span class="result-icon">✅</span>
                    <span class="result-title">생성 완료!</span>
                </div>
                <div id="resultList" class="result-list"></div>
                <button onclick="reset()" class="reset-btn">🔄 새로 만들기</button>
            </section>
        </main>

        <footer>
            <p class="footer-brand">10sec 적분 쇼츠 v1.0</p>
        </footer>
    </div>

    <script src="https://unpkg.com/@ffmpeg/ffmpeg@0.11.6/dist/ffmpeg.min.js" defer></script>
    <script src="./app.js"></script>
</body>
</html>
